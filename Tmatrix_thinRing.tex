

\section{An analytical model of the scattering by rings}
\label{sec:analytical_ring_scattering}

In order to describe how a 2d ring scatters electromagnetic waves an appropriate coordinate system should be chosen. This could be both, cylindrical ($\rho$, $\phi$, $z$) or spherical coordinates ($r$, $\theta$, $\phi$). From now on we will choose spherical coordinates and drop the harmonic time dependence $\exp(-\imag \omega t)$ . A complete set of zero-divergence (i. e. sourceless) vector fields is given by the Hansen multipoles \Cite{Hansen1935} 
\begin{equation}
\mathbf{M}_{\ell m} = \nabla \times\left( \unitv{r} z_\ell(kr) Y_{\ell m}(\theta, \phi)\right),
\label{eqn:HansenM}
\end{equation}
\begin{equation}
\mathbf{N}_{\ell m} = \frac{1}{k}\nabla \times \mathbf{M}_{\ell m}.
\label{eqn:HansenN}
\end{equation}
In \cref{eqn:HansenM} $z_\ell$ is any linear combination of spherical bessel functions $j_\ell(kr)$ and $y_\ell(kr)$ \Cite{DLMF_Bessel} of degree $\ell$. $r$ is the distance from the origin and $k$ the wave number. $Y_{\ell m}$ denote spherical harmonics of degree $\ell$ and order $m$ \Cite{DLMF_SphericalHarmonics}. Their dependence upon the azimut angle $\theta$ and polar angle $\phi$ is understood although not written out explicitly from now on.

An electromagnetic wave incident on a conducting ring (radius $R$ and width $w$) situated in the $xy$-plane induces currents in the ring which can only exist on the surface of the ring. If the ring possesses zero thickness in $z$-direction and zero width $w$ only currents flowing in $\unitv{\phi}$-direction can exist. Therefore we may expand the current density responsible for scattered waves in a fourier series in the coordinate $\phi$:
\begin{equation}
\mathbf{j}^\text{scat} = \sum_{p=-\infty}^\infty \mathrm{e}^{\imag p \phi} \unitv{\phi}K_p\; \delta(r-R) \delta(\theta-\pi/2) .
\label{eqn:ring_currents}
\end{equation}
Note that \cref{eqn:ring_currents} needs to be extended to include $\unitv{\theta}$ and $\unitv{r}$ components, if the ring possesses a finite thickness or a finite width, respectively. PEC boundary conditions force the components of $\mathbf{E}$ tangential to the surface of the ring to zero and by that determine the coefficients $K_p$.

The fields generated by the current density of \cref{eqn:ring_currents} can be
calculated by using the dyadic Green's function written in terms of vector spherical harmonics\footnote{There is also a freely available version of Gerhard Kristensson's lecture notes on "Spherical Vector Waves" \citep{Kristensson2014}.} \Cite{Kristensson2016}[chapter 7.5]:
\begin{equation}
\dyad{\mathbf{G}}(\mathbf{r},\mathbf{r}') = \imag k \sum_{\ell=1}^\infty \sum_{m=-\ell}^\ell
\mathbf{M}_{\ell m}(\mathbf{r})\otimes\mathbf{M}_{\ell m}^\dagger(\mathbf{r}')+
\mathbf{N}_{\ell m}(\mathbf{r})\otimes\mathbf{N}_{\ell m}^\dagger(\mathbf{r}'),
\label{eqn:Greens_Dyadic}
\end{equation}
where for the vector field depending upon the longer/shorter vector of $\mathbf{r}$ and $\mathbf{r}'$ spherical hankel/regular spherical bessel functions have to be used.\footnote{The term outgoing is owing to the choice of the $\exp\left(-\imag\omega t\right)$ time dependence.} The continuity of the two representations of \cref{eqn:Greens_Dyadic} is shown in \cref{sec:Gproof} for surface current densities on a sphere.
The dagger $^\dagger$ means complex conjugation of the vector fields $\mathbf{L}_{\ell m},\mathbf{X}_{\ell m},\mathbf{W}_{\ell m}$ of which the Hansen Multipoles consist, while not complex conjugating their radial dependence. $\otimes$ stands for the outer/dyadic product. With the aid of \cref{eqn:Greens_Dyadic} the scattered electric field can be calculated via:
\begin{equation}
\mathbf{E}^\text{scat}(\mathbf{r}) = \int_{\mathcal{R}^3}  \rd \mathbf{r}' 
\dyad{\mathbf{G}}(\mathbf{r},\mathbf{r}') \cdot \mathbf{j}^\text{scat}(\mathbf{r}').
\label{eqn:E_scattered}
\end{equation}

The scattered field of \cref{eqn:E_scattered} outside the source region (i. e. $r>r'$) can be therefore cast in the form:
\begin{equation}
\mathbf{E}^\text{scat}(\mathbf{r}) = \imag k \sum_{\ell=1}^\infty  \sum_{m=-\ell}^\ell
I_{\ell m}^\mathrm{(M)}\mathbf{M}_{\ell m}(\mathbf{r})+
I_{\ell m}^\mathrm{(E)}\mathbf{N}_{\ell m}(\mathbf{r}),
\label{eqn:Escat}
\end{equation}
where the Hansen Multipoles are written with regular spherical bessel functions. The expansion coefficients become
\begin{align}
I_{\ell m}^\text{(M)} = \int \rd^3\mathbf{r}' \mathbf{M}^*_{\ell m}(\mathbf{r}')\cdot
\mathbf{j}^\textbf{scat}(\mathbf{r}'),\\
I_{\ell m}^\text{(E)} = \int \rd^3\mathbf{r}' \mathbf{N}^*_{\ell m}(\mathbf{r}')\cdot
\mathbf{j}^\textbf{scat}(\mathbf{r}').
\end{align}
Due to the special form of the current density ($\propto \unitv{\phi}$) only the $\phi$-component of $\mathbf{M}_{\ell m}$ and $\mathbf{N}_{\ell m}$ survives (see. \cref{eqn:Xlm,eqn:Wlm,eqn:Llm,eqn:Mlm,eqn:Nlm}) and the above integrals can be evaluated in closed form:
\begin{align}
\left.I_{\ell m}^{(M)} = K^\mathrm{M}_{p}\delta_{p m} \mathcal{N}_{\ell m} j_\ell(kR)\left[-\frac{\displaystyle\rd}{\rd \theta}P_{\ell}^{(m)}(\cos(\theta))
\right]\right \vert_{\theta=\pi/2},\\
\left.I_{\ell m}^{(E)} =  K^\mathrm{E}_{p} \delta_{p m} \mathcal{N}_{\ell m}jd_\ell(kR)
\left[-\imag m 
P_\ell^{(m)}(\cos(\theta)) \right]\right\vert_{\theta=\pi/2}.
\end{align}
Here we introduced the abbreviations:
\begin{equation}
\mathcal{N}_{\ell m} = \sqrt{\frac{(2\ell+1)\pi}{\ell(\ell+1)}\frac{(\ell-|m|)!}{(\ell+|m|)!}},\quad
zd_\ell(x) = \frac{\partial_{x}  x z_\ell(x)}{x},
\end{equation}
where $z_\ell(x)$ can be either $j_\ell(x)$ or $h_\ell^{(1)}(x)$.
The associated Legendre polynomials and their derivative can be written \Cite{Leong1997}:
\begin{align}
\frac{\rd}{\rd \theta}P_\ell^{(m)}(0) =\left\{\ontop{}{}{
-\sin\big((\ell+m)\pi/2\big)\dfrac{2^{m+1}\Gamma\big((l+m)/2+1\big)}{\sqrt{\pi}\Gamma\big((l-m+1)/2\big) }
\quad : \quad (l+m)\%2=1}{\quad0\quad: \quad\text{otherwise}}\right\},
\label{eqn:Plm0diff}
\\
P_\ell^{(m)}(0) =
\left\{
\ontop{}{}{\cos\big((l+m)\pi/2\big)\dfrac{2^m \Gamma\big((n+m+1)/2\big)}{\sqrt{\pi}\Gamma\big((n-m)/2+1\big)}\quad:\quad (l+m)\%2=0}{0\quad:\quad \text{otherwise}}\right\}.
\label{eqn:Plm0}
\end{align}
What we can learn from the above reasoning is, that a thin ring situated in the $xy$-plane can only scatter magnetic multipoles if $l+m$ is odd whereas only electric multipoles with even $l+m$ can be scattered.
We can now write down the equation for the tangential part of the total electric field on the ring if a magnetic multipole is incoming:
\begin{align}
0&=\mathbf{E}^\mathrm{tot}(r=R,\theta=\pi/2,\phi)\cdot \unitv{\phi}\quad \forall \phi\\
\nonumber
\Leftrightarrow 0&=\left(\mathbf{M}^\mathrm{inc}_{\ell m} + \imag k \sum_{\nu=1}^\infty  \sum_{\mu=-\nu}^\nu
I_{\nu \mu}^\mathrm{(M)}\mathbf{M}^\mathrm{out}_{\nu \mu}(\mathbf{r})+
I_{\nu \mu}^\mathrm{(E)}\mathbf{N}^\mathrm{out}_{\nu \mu}(\mathbf{r})\right) \cdot \unitv{\phi},\quad \mathrm{at}\, r=R, \theta=\pi/2
\\
\nonumber
\Leftrightarrow 0&=
-j_\ell(kR)\mathcal{N}_{\ell m}\frac{\rd}{\rd\theta}P_{\ell m}(0) 
+
\imag k \sum_{\nu=1}^\infty  
-I_{\nu m}^\textbf{(M)}
h_\nu(kR)\mathcal{N}_{\nu m}\frac{\rd}{\rd\theta}P_{\nu m}(0) 
+
I_{\nu m}^\textbf{(E)}
hd_\nu(kR)\mathcal{N}_{\nu m}\imag m  P_{\nu m}(0) \\ \nonumber
\Leftrightarrow
0 &= -j_\ell(kR)\mathcal{N}_{\ell m}\frac{\rd}{\rd\theta}P_{\ell m}(0) 
+ \imag k\sum_{\nu = 1}^\infty
K^\mathrm{M}_{m}\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
\\ \nonumber
&+ \imag k\sum_{\nu = 1}^\infty
K^\mathrm{M}_{m} \Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
\\ \nonumber
&\Rightarrow K^\mathrm{M}_{m} = \frac{j_\ell(kR) \mathcal{N}_{\ell m}\dfrac{\rd}{\rd \theta}P_{\ell m}(0)}{\imag k \displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}
\end{align}
We thus know now, the current coefficients $K^\mathrm{M}_{\ell m}$ which go into the current density \cref{eqn:ring_currents} and lead to a scattered field which exactly cancels the tangential component of an incoming magnetic (M) multipole field of degree $\ell$ and order $m$. In order to
find the $\mathbb{T}$-Matrix of the ring, we now calculate \cref{eqn:Escat} to arrive at:
\begin{equation}
\mathbb{T}^\mathrm{MM}_{\ell_1 m;\ell_2 m} = -
\frac{j_{\ell_1}(kR)j_{\ell_2}(kR) \mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
\dfrac{\rd}{\rd \theta}P_{\ell_1 m}(0)\dfrac{\rd}{\rd \theta}P_{\ell_2,m}(0)}{\displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}
\end{equation}
If if do the same for the electric polarization we get:
\begin{align}
0&=\mathbf{E}^\mathrm{tot}\delta(r-R)\delta(\theta-\pi/2)\cdot \unitv{\phi} \\
\nonumber
\Leftrightarrow 0&=\left(\mathbf{N}^\mathrm{inc}_{\ell m} + \imag k \sum_{\nu=1}^\infty  \sum_{\mu=-\nu}^\nu
I_{\mu \nu}^\mathrm{(M)}\mathbf{M}^\mathrm{out}_{\mu \nu}(\mathbf{r})+
I_{\mu \nu}^\mathrm{(E)}\mathbf{N}^\mathrm{out}_{\mu \nu}(\mathbf{r})\right) \cdot \unitv{\phi}
\;\delta(r-R)\delta(\theta-\pi/2)\\
\nonumber
\Leftrightarrow 0&=
jd_\ell(kR)\mathcal{N}_{\ell m}\imag m P_{\ell m}(0) 
+
\imag k \sum_{\nu=1}^\infty  
-I_{\nu m}^\mathrm{(M)}
h_\nu(kR)\mathcal{N}_{\nu m}\frac{\rd}{\rd\theta}P_{\nu m}(0) 
+
I_{\nu m}^\mathrm{(E)}
hd_\nu(kR)\mathcal{N}_{\nu m}\imag m  P_{\nu m}(0) \\ \nonumber
\Leftrightarrow
0 &= jd_\ell(kR)\mathcal{N}_{\ell m}\imag m P_{\ell m}(0) 
+ \imag k\sum_{\nu = 1}^\infty
K^\mathrm{E}_{\ell m}\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
\\ \nonumber
&+ \imag k\sum_{\nu = 1}^\infty
K^\mathrm{E}_{\ell m} \Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
\\ \nonumber
&\Rightarrow K^\mathrm{E}_{\ell m} = \frac{jd_\ell(kR) \mathcal{N}_{\ell m}\imag mP_{\ell m}(0)}{\imag k \displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}
\end{align}
and arrive at the following result for the $\mathbb{T}$-matrix entries:
\begin{equation}
\mathbb{T}^\mathrm{EE}_{\ell_1 m;\ell_2 m} = -
\frac{jd_{\ell_1}(kR)jd_{\ell_2}(kR) 
\mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
m^2P_{\ell_1 m}(0)P_{\ell_2 m}(0)}{\displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}.
\end{equation}
The off-diagonal elements of the $\mathbb{T}$-matrix evaluate to:
\begin{equation}
\mathbb{T}^\mathrm{ME}_{\ell_1 m;\ell_2 m} = -
\frac{jd_{\ell_2}(kR) j_{\ell_1}(kR)
\mathcal{N}_{\ell_2 m}\mathcal{N}_{\ell_1 m}
\imag mP_{\ell_2 m}(0)\dfrac{\rd}{\rd \theta}P_{\ell_1 m}(0)
}{\displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}.
\end{equation}
\begin{equation}
\mathbb{T}^\mathrm{EM}_{\ell_1 m;\ell_2 m} = -
\frac{jd_{\ell_1}(kR) j_{\ell_2}(kR)
\mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
\imag mP_{\ell_1 m}(0)\dfrac{\rd}{\rd \theta}P_{\ell_2 m}(0)
}{\displaystyle \sum_{\nu=1}^\infty
\Big[
\mathcal{N}_{\nu m} \frac{\rd}{\rd \theta}P_{\nu m}(0)
\Big]^2 j_\nu(kR) h_\nu(kR)
+
\Big[
\mathcal{N}_{\nu m} P_{\nu m}(0) m
\Big]^2jd_\nu(kR) hd_\nu(kR)
}.
\end{equation}
As we can see all elements of the $\mathbb{T}$-matrix have the same denominator which we will now call $\mathrm{denom}_m(kR)$. This compactifies the obove expressions and we can express them with respect to the Mie coefficients of a perfectly conducting sphere of radius $R$:
\begin{align}
a_{\ell} &= -\dfrac{-\ell j_\ell(kR)+kR j_{\ell-1}(kR)}{-\ell h_\ell(kR)+kRh_{\ell-1}(kR)},\\
b_{\ell} &= -\dfrac{j_\ell(kR)}{h_\ell(kR)}
\end{align}
and becomes:
\begin{align}
\mathbb{T}^\mathrm{MM}_{\ell_1 m;\ell_2 m} &= b_{\ell_1} \frac{
j_{\ell_2}(kR)h_{\ell_1}(kR) \mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
\dfrac{\rd}{\rd \theta}P_{\ell_1 m}(0)\dfrac{\rd}{\rd \theta} P_{\ell_2 m}(0)
}{
\mathrm{denom}_m(kR)
},\\
%%
\mathbb{T}^\mathrm{EE}_{\ell_1 m;\ell_2 m} &= a_{\ell_1} \frac{
jd_{\ell_2}(kR)hd_{\ell_1}(kR) \mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
P_{\ell_1 m}(0) P_{\ell_2 m}(0)
}{
\mathrm{denom}_m(kR)
},\\
\mathbb{T}^\mathrm{ME}_{\ell_1 m;\ell_2 m} &= b_{\ell_1} \frac{
jd_{\ell_2}(kR)h_{\ell_1}(kR) \mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
\dfrac{\rd}{\rd \theta}P_{\ell_1 m}(0) P_{\ell_2 m}(0)
}{
\mathrm{denom}_m(kR)
},\\
\mathbb{T}^\mathrm{EM}_{\ell_1 m;\ell_2 m} &= a_{\ell_1} \frac{
j_{\ell_2}(kR)hd_{\ell_1}(kR) \mathcal{N}_{\ell_1 m}\mathcal{N}_{\ell_2 m}
P_{\ell_1 m}(0)\dfrac{\rd}{\rd \theta} P_{\ell_2 m}(0)
}{
\mathrm{denom}_m(kR)
}.
\end{align}