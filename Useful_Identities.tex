\section{Useful identities}
\subsection{Symmetry}
Consider the following integral occurring in xy-periodic structures:

\begin{equation}
I^{\mathrm{Y\mathbf{X}\mathbf{X}}}_{123} \equiv \int \rd \Omega \, Y_{\ell_1, m_1} \mathbf{X}_{\ell_2, m_2}\cdot \mathbf{X}^*_{\ell_3,m_3}.
\label{eqn:YXX_integral}
\end{equation}

Without the spherical harmonic $Y_{\ell_1,m_1}$ the obove integral would have yielded
1, since the VSH $\mathbf{X}_{\ell, m}$ is normalized with respect to integration over the surface of the unit-sphere and $\mathbf{X}_{\ell,m},\mathbf{W}_{\ell,m}$ form an orthogonal set of zero-divergence vectorfields. 

Lets carry out the dot product of the two vector spherical harmonics:
\begin{equation}
I^{\mathrm{Y\mathbf{X}\mathbf{X}}}_{123} =\frac{1}{\sqrt{\ell_2(\ell_2+1)\ell_3(\ell_3+1)}}\int \rd \Omega\, 
Y_{\ell_1,m_1}\left[
\frac{m_2 m_3}{\sin^2\theta} Y_{\ell_2,m_2} Y^*_{\ell_3, m_3}
+\partial_\theta Y_{\ell_2,m_2}\partial_\theta Y^*_{\ell_3,m_3}
\right]
\label{eqn:YXX_integral_split}
\end{equation}
\subsection{Vector Multipole Fields}
In spherical coordinates the vectorial Helmholtz equation possesses the set of
solutions:
\begin{align}
&& \mathbf{X}_{\ell m} &= \frac{1}{\sqrt{\ell(\ell+1)}} \left[
\unitv{\theta} \frac{1}{\sin(\theta)} \frac{\partial}{\partial \phi} Y_{\ell m} -
\unitv{\phi} \frac{\partial}{\partial \theta} Y_{\ell m}
\right], \label{eqn:Xlm}\\
&& \mathbf{W}_{\ell m} &= \frac{1}{\sqrt{\ell(\ell+1)}} \left[
\unitv{\theta} \frac{\partial}{\partial \theta} Y_{\ell m} +
\unitv{\phi} \frac{1}{\sin(\theta)} \frac{\partial}{\partial \phi} Y_{\ell m} 
\right], \label{eqn:Wlm}\\
&& \mathbf{L}_{\ell m} &= \unitv{r} Y_{\ell m},\label{eqn:Llm}
\end{align}
which are orthonormal upon integration over the unit-sphere. With \cref{eqn:Xlm,eqn:Wlm,eqn:Llm} one can construct the zero-divergence Hansen-Multipoles:
\begin{align}
&& \mathbf{M}_{\ell m} &= \mathbf{X}_{\ell m} z_\ell(kr), \\
&& \mathbf{N}_{\ell m} &= \sqrt{\ell(\ell+1)} \frac{z_\ell(kr)}{kr} \mathbf{L}_{\ell m}+
\frac{\frac{\partial}{\partial kr}\left[kr z_\ell(kr)\right]}{kr}\mathbf{W}_{\ell m}. \label{eqn:NlmVSH}
\end{align}



\subsection{Vector Multipole-Translations}
Suppose given is a multipole field vector:
\begin{equation}
\ket{\mathbf{E}_m^A} = \left[
Q^\text{M}_{\ell_\text{min},m}, Q^\text{M}_{\ell_\text{min}+1,m},...,
Q^\text{M}_{\ell_\text{max},m};
Q^\text{E}_{\ell_\text{min},m}, Q^\text{E}_{\ell_\text{min}+1,m},...,
Q^\text{E}_{\ell_\text{max},m}
\right]^T
\end{equation}
given in a frame of reference $A$ with magnetic and electric multipole coefficients $Q^\text{M}_{\ell,m}, Q^\text{E}_{\ell,m}$ indexed by the angular momentum number $\ell$ and its z-projection $m$. $\ell_\text{min}$ and $\ell_\text{max}$ shall denote the minimum angular momentum involved in the $m$-block, $\ell_\text{min}=\max(|m|,1)$ and $\ell_\text{max}$ is the maximum angular momentum we are interested in.

If we want to know the respective coefficients in a second frame of refernence, $B$ which is shifted by the vector $\mathbf{d}=\pm d \mathbf{z}$\footnote{Note that translations in the z-direction are especially simple since $m$ is conserved and that every frame of reference can always be rotated such that the vector $\mathbf{d}$ points along the $z$-axis.} relative to $A$ we apply the following translation relation:
\begin{equation}
\ket{\mathbf{E}_m^B} = \mathbb{V}^\text{m} \ket{\mathbf{E}_m^A},
\end{equation}
where $\mathbb{V}^\text{m}$ is a $2\times 2$ block-matrix
\begin{equation}
\mathbb{V}^m = \left[
\begin{matrix}
\mathbb{V}^{\mathrm{PP},m} & \mathbb{V}^{\mathrm{PQ},m} \\
\mathbb{V}^{\mathrm{PQ},m} & \mathbb{V}^{\mathrm{PP},m}
\end{matrix}
\right]
\end{equation}
with polarization conserving (mixing) entries denoted by the superscript PP (PQ) \Cite{Wittmann1988}:
\begin{align}
&&\left(\mathbb{V}^{\mathrm{PP},m}\right)_{\ell_1,\ell_2} &= 
C^{m,\pm}_{\ell_1,\ell_2} \sum_{\alpha=|\ell_1-\ell_2|}^{\ell_1+\ell_2}
D^m_{\ell_1,\ell_2,\alpha}(kd) 
\big[\ell_1(\ell_1+1) + \ell_2(\ell_2+1)-\alpha(\alpha+1)\big]\frac{1}{2},\\
&&\left(\mathbb{V}^{\mathrm{PQ},m}\right)_{\ell_1,\ell_2} &= \mp \imag m kd\,
C^{m,\pm}_{\ell_1,\ell_2} \,  \sum_{\alpha=|\ell_1-\ell_2|}^{\ell_1+\ell_2}
D^m_{\ell_1,\ell_2,\alpha}(kd).
\end{align}
We introduced the abbreviations:
\begin{align}
&&C^{m,\pm}_{\ell_1,\ell_2} &= \frac{(-1)^m (\pm \imag)^{\ell_1-\ell_2}2\sqrt{\pi}}
{\sqrt{\ell_1(\ell_1+1)\ell_2(\ell_2+1)}},\label{eqn:Ccoeff}
\\
&&D^m_{\ell_1,\ell_2,\alpha}(kd) &= \imag^\alpha \sqrt{2\alpha+1} z_\alpha(kd)
\mathrm{Y}^{\ell_1, \ell_2, \alpha}_{m,-m,0}\label{eqn:Dcoeff}
\end{align}
with the Gaunt-coefficients $\mathrm{Y}^{\ell_1 \ell_2 \alpha}_{m,-m,0}$, an integral of three spherical harmonics over the surface of the unit-sphere:
\begin{equation}
\mathrm{Y}^{\ell_1, \ell_2, \alpha}_{m,-m,0} = \int_{\partial B_1(0)} \rd \Omega \,
Y_{\ell_1,m}(\theta,\phi) Y_{\ell_2,-m}(\theta,\phi) Y_{\alpha,0} (\theta,\phi)
\label{eqn:Gaunt}
\end{equation}
and spherical bessel functions $z_\alpha(kd)$ which are to be understood to be either regular ($z_\alpha = j_\alpha$) or outgoing ($z_\alpha = h^{(1)}_\alpha$) depending on whether the orgin is inclosed in the region where the field is to be evaluated or not.  \capEref{eqn:Ccoeff}  depends upon the the sign of the translation, with $+$ for translations in positive $z$-direction and $-$ for translations in the opposite direction.

\subsection{Scattering by multiple scatterers}
If there is more than one scatterer, an appropriate formalism is needed to account for the joint scattering of all involved scatterers. 
For $N$ scatterers the electric field $\mathbf{E}$ can be expanded in a basis associated to the scattering site indexed by $i$:

\begin{equation}
\mathbf{E}_\mathrm{tot}^{(i)} = \mathbf{E}_\mathrm{inc}^{(i)} + 
\mathbf{E}_\mathrm{scat}^{(i)}.
\label{eqn:E_tot_site}
\end{equation}
The field incident on site $i$ contains the external field $\mathbf{E}_0$ and all fields which are scattered by the other ($j\neq i$) scatterers $j=1..N$:
\begin{equation}
\mathbf{E}_\mathrm{inc}^{(i)} = \mathbf{E}_0^{(i)} + \sum_{j=1,j\neq i}^N\mathbf{E}_\mathrm{scat}^{(j)}.
\end{equation}
At each scattering site the respective incident and scattered fields can be connected to each other by the scatterers $\mathbb{T}$-Matrix:
\begin{equation}
\mathbf{E}_\mathrm{scat}^{(i)} = \mathbb{T}^{(i)} \mathbf{E}^{(i)}_\mathrm{inc}.
\end{equation}
Therefore the expression for the total field, \cref{eqn:E_tot_site}, can be written
\begin{equation}
\mathbf{E}_\mathrm{tot}^{(i)} = \left(\mathbb{I}+\mathbb{T}^{(i)}\right)\mathbf{E}^{(i)}_\mathrm{inc},
\end{equation}
whereas the scattered field at site $i$, which in most cases is the most important quantity, is
\begin{equation}
\mathbf{E}_\mathrm{scat}^{(i)} = \mathbb{T}^{(i)} \left(
\mathbf{E}_0^{(i)} + \sum_{j\neq i} \mathbf{E}^{(j)}_\mathrm{scat}
\right)
\end{equation}
and can be rearranged to:
\begin{equation}
\mathbf{E}_\mathrm{scat}^{(i)}-\mathbb{T}^{(i)}\sum_{j\neq i} \mathbf{E}^{(j)}_\mathrm{scat} = \mathbb{T}^{(i)}
\mathbf{E}_0^{(i)}.
\label{eqn:Escat_to_Einc}
\end{equation}
If we collect the fields at all sites $i$ into the vector $\mathbf{E}=\left[
\mathbf{E}^{(1)},...,\mathbf{E}^{(N)}
\right]^T$, arrange the $\mathbb{T}$-matrices into a diagonal matrix 
\begin{equation}
\mathbb{T} = 
\left(
\begin{matrix}
\mathbb{T}_1 & 0 & ... & 0 \\
0 & \mathbb{T}_2 & ... & 0 \\
\vdotswithin{\ldots} & \ldots &  \ldots & \vdotswithin{\ldots} \\
0 & ... & 0 & \mathbb{T}_N\\
\end{matrix}
\right)
\end{equation}
and introduce the matrix $\mathbf{U}$ containing multipole translations from non-coinciding scattering sites
\begin{equation}
\mathbb{U} = 
\left(
\begin{matrix}
0 & \mathbb{U}_{12} & ... & \mathbb{U}_{1 N} \\
\mathbb{U}_{21} & 0 & ... & \mathbb{U}_{2 N} \\
\vdotswithin{\ldots} & \ldots &  \ldots & \vdotswithin{\ldots} \\
\mathbb{U}_{N 1} & ... & \mathbb{U}_{N N-1} & 0\\
\end{matrix}
\right),
\end{equation}
then \cref{eqn:Escat_to_Einc} can be written in compact matrix form as
\begin{equation}
\left(\mathbb{I}-\mathbb{T} \mathbb{U}\right)\mathbf{E}_\mathrm{scat} = 
\mathbb{T} \mathbf{E}_0.
\label{eqn:matrix_form}
\end{equation}
The scattered fields can therefore be obtained if a matrix inversion is done:
\begin{equation}
\mathbf{E}_\mathrm{scat} = \left(\mathbb{I}-\mathbb{T} \mathbb{U}\right)^{-1}
\mathbb{T} \mathbf{E}_0.
\label{eqn:matrix_form}
\end{equation}


which contains the external field $\mathbf{E}_0$ and all fields scattered by the other scatterers.
\begin{equation}
\mathcal{R} = 
\left(
\begin{matrix}
\mathbb{T}_1 & 0 & ... & 0 \\
0 & \mathbb{T}_2 & ... & 0 \\
\vdotswithin{\ldots} & \ldots &  \ldots & \vdotswithin{\ldots} \\
0 & ... & 0 & \mathbb{T}_N\\
\end{matrix}
\right)
\left(\begin{matrix}
\mathbb{I} & \mathbb{U}_{21} & ... & \mathbb{U}_{N 1} \\
\mathbb{U}_{12} & \mathbb{I} & ... & \mathbb{U}_{N 2} \\
\vdotswithin{\mathbb{U}_{13}} & \vdotswithin{\ldots} & \ldots & \vdotswithin{\ldots} \\
\mathbb{U}_{1 N} & \mathbb{U}_{2 N} & \ldots & \mathbb{U}_{N N} 
\end{matrix}\right)
\end{equation}
defines fields $\ket{\mathbf{E}}$ satisfying the equation
\begin{equation}
\left(\mathcal{R}-\mathbb{I}\right)\ket{\mathbf{E}} = 0,
\end{equation}
which makes those $\ket{\mathbf{E}}$ eigensolutions of the $N$-body multiple-scattering problem.